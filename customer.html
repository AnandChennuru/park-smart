<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ParkSmart â€” Customer Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body data-page="customer">

  <!-- ===== NAVBAR ===== -->
  <nav class="navbar">
    <div class="container">
      <a href="index.html" class="navbar-brand">ğŸ…¿ï¸ Park<span class="brand-accent">Smart</span></a>
      <div class="nav-links">
        <button class="tab-nav-btn active" onclick="custNav('browse', this)">ğŸ” Browse</button>
        <button class="tab-nav-btn" onclick="custNav('bookings', this)">ğŸ« My Bookings</button>
        <button class="tab-nav-btn" onclick="custNav('history', this)">ğŸ“‹ History</button>
        <button class="tab-nav-btn" onclick="custNav('mispark', this)">ğŸš¨ Mispark</button>
        <div class="nav-user">
          <span id="custGreeting"></span>
          <span class="nav-role-badge role-customer">Customer</span>
        </div>
        <button class="btn btn-sm btn-secondary" onclick="logout()">Logout</button>
      </div>
    </div>
  </nav>

  <div class="container" style="padding-top: 24px; padding-bottom: 40px;">

    <!-- ===== BROWSE PARKINGS ===== -->
    <div class="page-section active" id="sec-browse">
      <div class="flex-between mb-3">
        <div>
          <h2 class="section-title">ğŸ” Available Parking</h2>
          <p class="section-subtitle">Real-time available parking locations near you</p>
        </div>
        <div class="search-bar">
          <span class="search-icon">ğŸ”</span>
          <input type="text" id="parkingSearch" placeholder="Search by name or area..." oninput="filterParkings(this.value)">
        </div>
      </div>

      <!-- Filters -->
      <div class="flex-gap mb-3" style="flex-wrap:wrap;">
        <button class="btn btn-sm btn-outline" onclick="filterByVehicle('')" id="vf-all" style="border-color:var(--primary);background:var(--primary-light);color:var(--primary-dark);">All Types</button>
        <button class="btn btn-sm btn-ghost" onclick="filterByVehicle('car')" id="vf-car">ğŸš— Car</button>
        <button class="btn btn-sm btn-ghost" onclick="filterByVehicle('bike')" id="vf-bike">ğŸï¸ Bike</button>
        <button class="btn btn-sm btn-ghost" onclick="filterByVehicle('ev')" id="vf-ev">âš¡ EV</button>
        <div style="margin-left:auto;display:flex;align-items:center;gap:8px;font-size:0.85rem;color:var(--gray-500);">
          <span id="refreshTimer">ğŸ”„</span>
          <button class="btn btn-sm btn-ghost" onclick="renderCustomerParkings()">Refresh</button>
        </div>
      </div>

      <div id="customerParkingsList"></div>
    </div>

    <!-- ===== PARKING DETAIL + BOOKING ===== -->
    <div class="page-section" id="sec-parking-detail">
      <button class="btn btn-ghost btn-sm mb-3" onclick="custNav('browse')">â† Back to Browse</button>
      <div id="parkingDetailView"></div>
    </div>

    <!-- ===== ACTIVE BOOKINGS ===== -->
    <div class="page-section" id="sec-bookings">
      <h2 class="section-title">ğŸ« Active Bookings</h2>
      <p class="section-subtitle">Your currently active parking sessions</p>
      <div id="activeBookingsList"></div>
    </div>

    <!-- ===== BOOKING HISTORY ===== -->
    <div class="page-section" id="sec-history">
      <h2 class="section-title">ğŸ“‹ Booking History</h2>
      <p class="section-subtitle">All your past parking sessions and receipts</p>
      <div id="historyBookingsList"></div>
    </div>

    <!-- ===== MISPARK DETECTION ===== -->
    <div class="page-section" id="sec-mispark">
      <h2 class="section-title">ğŸš¨ Mispark Detection</h2>
      <p class="section-subtitle">Verify your vehicle is in the correct assigned slot</p>
      <div class="card" style="max-width: 500px;">
        <form id="misparkForm" onsubmit="handleMisparkCheck(event)">
          <div class="form-group">
            <label>Select Your Active Booking</label>
            <select id="misparkBookingSelect" required>
              <option value="">-- Select an active booking --</option>
            </select>
          </div>
          <div class="form-group">
            <label>Current Parked Slot (where your vehicle actually is)</label>
            <input type="text" id="misparkCurrentSlot" required placeholder="e.g., F1-A3">
          </div>
          <button type="submit" class="btn btn-primary btn-block">ğŸ” Check Slot</button>
        </form>
        <div id="misparkResult"></div>
      </div>
    </div>

  </div>

  <!-- ===== BOOKING FORM MODAL ===== -->
  <div class="modal-overlay" id="bookingFormModal">
    <div class="modal" style="max-width:520px;">
      <div class="modal-header">
        <h2>ğŸ« Book Parking Slot</h2>
        <button class="modal-close" onclick="closeBookingFormModal()">âœ•</button>
      </div>
      <div class="modal-body" id="bookingFormModalBody"></div>
    </div>
  </div>

  <!-- ===== RECEIPT MODAL ===== -->
  <div class="modal-overlay" id="receiptModal">
    <div class="modal" style="max-width:460px;">
      <div class="modal-header">
        <h2>ğŸ§¾ Parking Receipt</h2>
        <button class="modal-close" onclick="closeReceiptModal()">âœ•</button>
      </div>
      <div class="modal-body" id="receiptModalBody"></div>
      <div class="modal-footer">
        <button class="btn btn-primary btn-block" onclick="closeReceiptModal()">Close</button>
      </div>
    </div>
  </div>

  <!-- ===== SLOT GRID MODAL ===== -->
  <div class="modal-overlay" id="custSlotModal">
    <div class="modal" style="max-width:820px;">
      <div class="modal-header">
        <h2 id="custSlotModalTitle">Select a Slot</h2>
        <button class="modal-close" onclick="closeCustSlotModal()">âœ•</button>
      </div>
      <div class="modal-body" id="custSlotModalBody"></div>
    </div>
  </div>

  <div class="toast-container" id="toastContainer"></div>

  <footer class="footer">
    <div class="footer-grid">
      <div>
        <div class="footer-brand">ğŸ…¿ï¸ Park<span class="accent">Smart</span></div>
        <p class="footer-desc">Smart parking made simple for every driver.</p>
      </div>
      <div>
        <div class="footer-title">Support</div>
        <ul class="footer-links">
          <li><a href="#">Help Center</a></li>
          <li><a href="#">Report Issue</a></li>
          <li><a href="#">Contact Us</a></li>
        </ul>
      </div>
      <div class="footer-contact">
        <div class="footer-title">Contact</div>
        <p>ğŸ“§ support@parksmart.in</p>
        <p>ğŸ“ +91 98765 43210</p>
        <p>ğŸ• 24/7 Support</p>
      </div>
    </div>
    <div class="footer-bottom"><p>ğŸ…¿ï¸ ParkSmart &copy; 2025 â€” Customer Portal</p></div>
  </footer>

  <script src="script.js"></script>
</body>
</html>
